{% load next_url %}

<div class="flex direction-column gap-0-5 no-bottom-margin">
  {% for affiliation in interface.affiliations %}
    <div class="flex wrap space-between items-center column-gap-4">
      <div class="max-w-28">
        {% if interface.affiliations|length > 1 %}
          {% include "admin/core/affiliation_display.html" with affiliation=affiliation display_primary=True %}
        {% else %}
          {% include "admin/core/affiliation_display.html" with affiliation=affiliation display_primary=False %}
        {% endif %}
      </div>
      <div class="button-group small no-bottom-margin">
        {% if article %}
          {% url_with_return "submission_affiliation_update" article.pk author.pk affiliation.pk as edit_url %}
          {% url_with_return "submission_affiliation_delete" article.pk author.pk affiliation.pk as remove_url %}
        {% else %}
          {% url_with_return 'core_affiliation_update' affiliation.pk as edit_url %}
          {% url_with_return 'core_affiliation_delete' affiliation.pk as remove_url %}
        {% endif %}
        {% trans "Edit affiliation" as edit_label %}
        {% include "elements/a_edit.html" with href=edit_url label=edit_label %}
        {% trans "Remove affiliation" as remove_label %}
        {% include "elements/a_remove.html" with href=remove_url label=remove_label %}
      </div>
    </div>
  {% empty %}
    <div>{% trans "No affiliations." %}</div>
  {% endfor %}
  <div class="bs-callout bs-callout-info flex">
    <div class="button-group no-bottom-margin">
      {% if interface.orcid %}
        {% if article %}
          {% url_with_return 'submission_affiliation_update_from_orcid' article.pk author.pk 'primary' as primary_url %}
          {% url_with_return 'submission_affiliation_update_from_orcid' article.pk author.pk 'all' as all_url %}
        {% else %}
          {% url_with_return 'core_affiliation_update_from_orcid' 'primary' as primary_url %}
          {% url_with_return 'core_affiliation_update_from_orcid' 'all' as all_url %}
        {% endif %}

        {% trans "Get primary affiliation from ORCID" as primary_label %}
        {% with href=primary_url label=primary_label icon="fa-star" %}
          {% include "elements/a_menu_item.html" %}
        {% endwith %}
        {% trans "Update all affiliations from ORCID" as all_label %}
        {% with href=all_url label=all_label icon="fa-refresh" %}
          {% include "elements/a_menu_item.html" %}
        {% endwith %}
      {% endif %}
      {% if article %}
        {% url_with_return 'submission_organization_search' article.pk author.pk as create_url %}
      {% else %}
        {% url_with_return 'core_organization_search' as create_url %}
      {% endif %}
      {% with label="Add affiliation" href=create_url %}
        {% include "elements/a_create.html" %}
      {% endwith %}
    </div>
  </div>
</div>
