{% extends "admin/core/base.html" %}
{% load foundation static %}

{% block title %}{{ object.title }} Discussions{% endblock %}
{% block title-section %}{{ object_type|capfirst }}: {{ object.title }} Discussions{% endblock %}

{% block css %}
    {{ block.super }}
    <link href="{% static "admin/css/discussions.css" %}" rel="stylesheet">
{% endblock %}

{% block breadcrumbs %}
  {{ block.super }}
  {% if object_type == "article" %}
    <li>
      <a href="{{ object.current_workflow_element_url }}">{{ object.title }}</a>
    </li>
    <li>
      Discussions
    </li>
  {% endif %}
{% endblock %}

{% block body %}
<div class="row expanded">
    <div class="large-3 columns thread-box-left">
        <div class="box thread-box thread-dark"
             id="thread-list-container"
             hx-get="{% url 'discussion_threads_list_partial' object_type object.pk %}"
             hx-trigger="load"
             hx-swap="innerHTML">
             <i class="fa fa-spinner fa-spin"></i> Loading threads...
        </div>
    </div>

    <div class="large-9 columns thread-box-right">
        <div class="box thread-box"
             id="thread-detail-container"
             {% if active_thread_id %}
                 hx-get="{% url 'discussion_thread_detail_partial' object_type object.pk active_thread_id %}"
                 hx-trigger="load"
                 hx-swap="innerHTML"
             {% endif %}>
            {% if not active_thread_id %}
                <div class="empty-state">
                    <p class="subheader">Select a thread to display posts.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<div class="reveal small" id="new_thread_modal" data-reveal data-animation-in="slide-in-up"
     data-animation-out="slide-out-down">
</div>
{% endblock body %}

{% block js %}
    {{ block.super }}
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    {% include "admin/discussion/partials/htmx_error_toast.html" %}
{% endblock %}
